V13 MapboxGl
<!doctype html>
<html lang="en" data-baseline="stable-2025-10-01__rails-460px__galC-6-only">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Gardenicity — Hero → S1 → S2 → gallery-A → Geddes → S3 → S4 → MapA (GL JS V13 - V2 Clean + Button Exit) → S5 → gallery-B → S8 → S9 → gallery-C → S11 → S12 → S13 → S14 → S15</title>

<link href="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.css" rel="stylesheet" />

<style>

/* ===== Base (unchanged) ===== */
html,body{
margin:0; padding:0; height:100%;
background:#f8fbf2; color:#fff;
font-family:"Acumin Pro",system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
}
:root{
/* HERO */
--shift:0px; --titleOpacity:0; --linksOpacity:0; --heroAlpha:1; --heroBlur:0;
/* S1 */
--s1:0; --s1Overlay:0; --s1Y:0px; --s1ImgOpacity:0;
/* S2 */
--s2:0; --s2Overlay:0; --s2Y:0px; --s2ImgOpacity:0;
/* gallery-A-Left */
--galA:0;
--galAImg0Opacity:0; --galAImg1Opacity:0; --galAImg2Opacity:0; --galAImg3Opacity:0;
--galAReady:0;

/* NEW: GEDDES PLAN (Like S2) */
--sGeddes:0; --sGeddesOverlay:0; --sGeddesY:0px; --sGeddesImgOpacity:0;

/* S3 (full bleed) */
--s3:0; --s3ImgOpacity:0; --s3Scale:1;
/* S4 */
--s4:0; --s4Overlay:0; --s4Y:0px; --s4ImgOpacity:0;
/* NEW MAP SECTION */
--sMapA:0; --sMapAImgOpacity:0;
/* S5 */
--s5:0; --s5Overlay:0; --s5Y:0px; --s5ImgOpacity:0;
/* gallery-B-Center */
--galB:0;
--galBImg0Opacity:0; --galBImg1Opacity:0; --galBImg2Opacity:0; --galBImg3Opacity:0; --galBImg4Opacity:0;
--galBReady:0;
/* S8 (full bleed) */
--s8:0; --s8ImgOpacity:0; --s8Scale:1; --s8Ready:0;
/* S9 */
--s9:0; --s9Overlay:0; --s9Y:0px; --s9ImgOpacity:0;
/* gallery-C-Right (media left, no text) */
--galC:0;
--galCImg0Opacity:0; --galCImg1Opacity:0; --galCImg2Opacity:0; --galCImg3Opacity:0; --galCImg4Opacity:0; --galCImg5Opacity:0;
--galCReady:0;
/* S11 (left text / right image) */
--s11:0; --s11Overlay:0; --s11Y:0px; --s11ImgOpacity:0;
/* S12 (full bleed) */
--s12:0; --s12ImgOpacity:0; --s12Scale:1; --s12Ready:0;
/* S13 (like S1) */
--s13:0; --s13Overlay:0; --s13Y:0px; --s13ImgOpacity:0;
/* S14 (like S2) */
--s14:0; --s14Overlay:0; --s14Y:0px; --s14ImgOpacity:0;
/* S15 (full bleed + centered overlay) */
--s15:0; --s15Overlay:0; --s15Y:0px; --s15ImgOpacity:0; --s15Scale:1; --s15Ready:0;
}

/* ===== HERO (unchanged) ===== */
.hero-fixed{
position:fixed; inset:0; z-index:3;
opacity:var(--heroAlpha);
filter:blur(calc(var(--heroBlur)*10px));
pointer-events:auto; will-change:opacity,filter;
}
.hero-bg{
position:absolute; inset:0;
background:url("assets/hero1cg.jpg") center/cover no-repeat;
opacity:0; animation:heroIn 900ms ease-out forwards; pointer-events:none;
}
@keyframes heroIn{ from{opacity:0} to{opacity:1} }
.hero-media{
position:absolute; top:96px; bottom:96px; left:96px; right:82px;
display:flex; align-items:flex-end; justify-content:flex-start; overflow:hidden;
}
.col{ position:relative; max-width:700px; transform:translateY(var(--shift)); will-change:transform; }
.hero-title{ margin:0 0 24px 0; font-weight:400; font-size:100px; line-height:100px; opacity:var(--titleOpacity); }
.hero-title .line{ display:block; }
.hero-links{ display:flex; flex-direction:column; gap:10px; font-size:24px; line-height:30px; opacity:var(--linksOpacity); }
.hero-links a{ color:#fff; text-decoration:none; transition:color .2s ease; }
.hero-links a:hover,.hero-links a:focus-visible{ color:#00A86B; }
.driver{ height:200vh; }

/* ===== PINNED FRAMES (unchanged) ===== */
figure.frame { margin: 0; }

.frame {
  position: fixed;
  z-index: 1;
  pointer-events: none;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

.frame img {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: block;
}

/* === MapA: base state (GL JS DIV) === */
.sMapA-frame {
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
  opacity: var(--sMapAImgOpacity);
  z-index: 4;
}

/* === Map container (GL JS DIV) === */
#mapA-container { 
  width: 100%;
  height: 100%;
  position: relative; 
  /* V13: Apply CSS hard lock by default (V2 behavior). */
  pointer-events: none; 
  z-index: 10 !important;
  cursor: default;
}

/* Cursor when map is active */
#mapA-container.map-active {
    cursor: grab;
}
#mapA-container.map-active:active {
    cursor: grabbing;
}

/* V13: Exit Button Styling */
#map-exit-button {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20; 
    padding: 10px 20px;
    background-color: #00A86B; /* Green */
    color: white;
    font-size: 16px;
    font-weight: bold;
    border-radius: 5px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0,0,0,0.4);
    transition: opacity 0.2s;
    opacity: 0; /* Hidden by default */
    pointer-events: none; /* Crucial: Cannot be clicked when hidden */
}
#mapA-container.map-active #map-exit-button {
    opacity: 1;
    pointer-events: auto;
}

/* IMPORTANT: Mapbox GL JS map container must have a fixed size */
.sMapA-frame, #mapA-container {
    width: 100%;
    height: 100%;
}

/* Optional debug outline */
.sMapA-frame.active {
  outline: 3px solid limegreen;
}

/* === Disable map when faded === */
.sMapA-frame[style*="opacity:0"] {
  pointer-events: none !important;
}

/* S1 image RIGHT (text left) */
.s1-frame {
  top: 96px;
  bottom: 96px;
  left: calc(96px + 460px + 96px);
  right: 82px;
  opacity: var(--s1ImgOpacity);
}

/* (All other frame styles remain the same) */
.s2-frame{
top:96px; bottom:96px;
left: 96px;
right: calc(82px + 96px + 460px);
opacity: var(--s2ImgOpacity);
}
.sGeddes-frame {
  top: 96px;
  bottom: 96px;
  left: 96px;
  right: calc(82px + 96px + 460px);
  opacity: var(--sGeddesImgOpacity);
}
.s3-frame, .s8-frame, .s12-frame, .s15-frame {
  top: 0; right: 0; bottom: 0; left: 0;
  opacity: var(--s3ImgOpacity);
}
.s4-frame {
  top: 96px; bottom: 96px;
  left: calc(96px + 460px + 96px);
  right: 82px;
  opacity: var(--s4ImgOpacity);
}
.s5-frame {
  top: 96px; bottom: 96px;
  left: 96px;
  right: calc(82px + 96px + 460px);
  opacity: var(--s5ImgOpacity);
}
.s9-frame {
  top: 96px; bottom: 96px;
  left: calc(96px + 460px + 96px);
  right: 82px;
  opacity: var(--s9ImgOpacity);
}
.s11-frame {
  top: 96px; bottom: 96px;
  left: calc(96px + 460px + 96px);
  right: 82px;
  opacity: var(--s11ImgOpacity);
}
.s13-frame {
  top: 96px; bottom: 96px;
  left: calc(96px + 460px + 96px);
  right: 82px;
  opacity: var(--s13ImgOpacity);
}
.s14-frame {
  top: 96px; bottom: 96px;
  left: 96px;
  right: calc(82px + 96px + 460px);
  opacity: var(--s14ImgOpacity);
}

/* ===== SECTION DRIVERS (unchanged) ===== */
.s1-wrap, .s2-wrap, .galA-left-wrap,
.sGeddes-wrap, 
.s3-wrap, .s4-wrap, .s5-wrap,
.sMapA-wrap, 
.galB-center-wrap, .s8-wrap, .s9-wrap, .galC-left-wrap, .s11-wrap, .s12-wrap,
.s13-wrap, .s14-wrap, .s15-wrap{
position:relative; height:280vh; background:#f8fbf2;
}

/* === Global scroll restore === */
body, html {
  overscroll-behavior: auto;
}

/* Prevent invisible fixed frames (like MapA when faded) from blocking mouse scroll */
.frame[style*="opacity:0"],
.frame[style*="opacity: 0"] {
  pointer-events: none !important;
}

</style>
</head>
<body>

<div class="hero-fixed" id="hero">
<div class="hero-bg" aria-hidden="true"></div>
<div class="hero-media" id="hero-media">
<div class="col" id="hero-col">
<h1 class="hero-title" id="hero-title">
<span class="line">Gardenicity</span>
<span class="line">Civic Green</span>
</h1>
<nav class="hero-links" id="hero-links" aria-label="Primary">
<a href="https://www.megama.net">What Did Geddes See</a>
<a href="https://www.megama.net">Growth</a>
<a href="https://www.megama.net">Sustenance</a>
<a href="https://www.megama.net">Leafy SDGs</a>
<a href="https://www.megama.net">EN/עב</a>
</nav>
</div>
</div>
</div>

<section class="driver" id="driver"></section>
<figure class="frame s1-frame" aria-hidden="true"><img id="s1-img" src="assets/section1.jpg" alt=""></figure>
<figure class="frame s2-frame" aria-hidden="true"><img id="s2-img" src="assets/section2.jpg" alt=""></figure>
<figure class="frame galA-left-frame" aria-hidden="true">
<img id="galA-img0" src="assets/gallery-A.jpg" alt="">
<img id="galA-img1" src="assets/gallery-A1.jpg" alt="">
<img id="galA-img2" src="assets/gallery-A2.jpg" alt="">
<img id="galA-img3" src="assets/gallery-A3.jpg" alt="">
</figure>
<figure class="frame sGeddes-frame" aria-hidden="true"><img id="sGeddes-img" src="assets/geddesplan.jpg" alt=""></figure>
<figure class="frame s3-frame" aria-hidden="true"><img id="s3-img" src="assets/section3.jpg" alt=""></figure>
<figure class="frame s4-frame" aria-hidden="true"><img id="s4-img" src="assets/section4.jpg" alt=""></figure>

<figure class="frame sMapA-frame" aria-hidden="true">
    <div id="mapA-container">
        <div id="map-exit-button">
            Continue Story ⬇️
        </div>
    </div>
</figure>
<figure class="frame s5-frame" aria-hidden="true"><img id="s5-img" src="assets/section5.jpg" alt=""></figure>
<figure class="frame galB-center-frame" aria-hidden="true">
<img id="galB-img0" src="assets/gallery-B.jpg" alt="">
<img id="galB-img1" src="assets/gallery-B1.jpg" alt="">
<img id="galB-img2" src="assets/gallery-B2.jpg" alt="">
<img id="galB-img3" src="assets/gallery-B3.jpg" alt="">
<img id="galB-img4" src="assets/gallery-B4.jpg" alt="">
</figure>
<figure class="frame s8-frame" aria-hidden="true">
<img id="s8-img" src="assets/section8.jpg" alt="">
</figure>
<figure class="frame s9-frame" aria-hidden="true"><img id="s9-img" src="assets/section9.jpg" alt=""></figure>
<figure class="frame galC-left-frame" aria-hidden="true">
<img id="galC-img0" src="assets/gallery-C.jpg" alt="">
<img id="galC-img1" src="assets/gallery-C1.jpg" alt="">
<img id="galC-img2" src="assets/gallery-C2.jpg" alt="">
<img id="galC-img3" src="assets/gallery-C3.jpg" alt="">
<img id="galC-img4" src="assets/gallery-C4.jpg" alt="">
<img id="galC-img5" src="assets/gallery-C5.jpg" alt="">
</figure>
<figure class="frame s11-frame" aria-hidden="true"><img id="s11-img" src="assets/section11.jpg" alt=""></figure>
<figure class="frame s12-frame" aria-hidden="true">
<img id="s12-img" src="assets/section12.jpg" alt="">
</figure>
<figure class="frame s13-frame" aria-hidden="true"><img id="s13-img" src="assets/section13.jpg" alt=""></figure>
<figure class="frame s14-frame" aria-hidden="true"><img id="s14-img" src="assets/section14.jpg" alt=""></figure>
<figure class="frame s15-frame" aria-hidden="true">
<img id="s15-img" src="assets/section15.jpg" alt="">
</figure>


<section class="s1-wrap" id="s1-wrap"></section>
<div class="s1-overlay">
<div class="s1-rail">
<div class="s1-text" id="s1-text">
<p><strong>HOURS AFTER MY</strong> mother took her last breath on earth…</p>
<p>After we opened the windows to let the spirits out…</p>
<p>After we lit incense stick after incense stick…</p>
<p>After we watched MMA fighters on TV in the basement…</p>
<p>And the smoke kept rising. The chain must not be broken. **\*Lorem ipsum dolor sit amet, consectetur adipiscing elit.
Aliquam varius, metus nec tincidunt tincidunt, nunc erat tincidunt sapien, vel laoreet lacus nisi eget justo. Nullam ut placerat odio.
Nulla vitae eros nec mi rutrum eleifend at nec dui. Duis ultricies consequat lobortis.
Fusce a aliquam lorem, ac lacinia est. Praesent rutrum odio eget tellus mattis, at malesuada lorem dapibus.
Pellentesque accumsan dui a lectus porttitor vestibulum. Nam venenatis urna elit, at condimentum eros elementum interdum. Proin sed semper nulla.
Mauris placerat non dui at pretium. Ut aliquam tellus ipsum, non porta ex congue a.
Vestibulum molestie egestas tellus, vitae tincidunt nibh mollis nec.
Fusce quis magna elit. Aenean mi tellus, fermentum eu pharetra id, fermentum non turpis. **\*</p>
</div>
</div>
</div>

<section class="s2-wrap" id="s2-wrap"></section>
<div class="s2-overlay">
<div class="s2-rail">
<div class="s2-text" id="s2-text">
<p><strong>SECTION TWO</strong> opens as the previous memory fades…</p>
<p>Now the perspective widens to a new frame…</p>
<p>The city’s edge meets the garden…</p>
<p>We follow the lines of growth and care…</p>
<p>And learn how places hold time. **\*Lorem ipsum dolor sit amet, consectetur adipiscing elit.
Aliquam varius, metus nec tincidunt tincidunt, nunc erat tincidunt sapien, vel laoreet lacus nisi eget justo. Nullam ut placerat odio.
Nulla vitae eros nec mi rutrum eleifend at nec dui. Duis ultricies consequat lobortis.
Fusce a aliquam lorem, ac lacinia est. Praesent rutrum odio eget tellus mattis, at malesuada lorem dapibus.
Pellentesque accumsan dui a lectus porttitor vestibulum. Nam venenatis urna elit, at condimentum eros elementum interdum. Proin sed semper nulla.
Mauris placerat non dui at pretium. Ut aliquam tellus ipsum, non porta ex congue a.
Vestibulum molestie egestas tellus, vitae tincidunt nibh mollis nec.
Fusce quis magna elit. Aenean mi tellus, fermentum eu pharetra id, fermentum non turpis. **\*</p>
</div>
</div>
</div>

<section class="galA-left-wrap" id="galA-wrap"></section>
<section class="sGeddes-wrap" id="sGeddes-wrap"></section>
<div class="sGeddes-overlay">
  <div class="sGeddes-rail">
    <div class="sGeddes-text" id="sGeddes-text">
      <p><strong>GEDDES PLAN</strong></p>
      <p>Your text content for the Geddes Plan goes here...</p>
      <p>It behaves exactly like Section 2 (Right Rail / Left Image).</p>
    </div>
  </div>
</div>
<section class="s3-wrap" id="s3-wrap"></section>
<section class="s4-wrap" id="s4-wrap"></section>
<div class="s4-overlay">
<div class="s4-rail">
<div class="s4-text" id="s4-text">
<p><strong>SECTION FOUR</strong> returns to the tight frame…</p>
<p>Left-rail narration continues the thread…</p>
<p>The horizontal image sits steady at right…</p>
<p>Margins and rhythm match Section One…</p>
<p>And the cycle of views goes on.</p>
</div>
</div>
</div>

<section class="sMapA-wrap" id="sMapA-wrap"></section>
<section class="s5-wrap" id="s5-wrap"></section>
<div class="s5-overlay">
<div class="s5-rail">
<div class="s5-text" id="s5-text">
<p><strong>SECTION FIVE</strong> shifts the rail again…</p>
<p>Now the narration hugs the right margin…</p>
<p>While the image holds the left field of view…</p>
<p>Framing the next turn in the story…</p>
<p>With the same cadence and pace.</p>
</div>
</div>
</div>

<section class="galB-center-wrap" id="galB-wrap"></section>
<section class="s8-wrap" id="s8-wrap"></section>
<section class="s9-wrap" id="s9-wrap"></section>
<div class="s9-overlay">
<div class="s9-rail">
<div class="s9-text" id="s9-text">
<p><strong>SECTION NINE</strong> brings us back to the close frame…</p>
<p>The left rail carries the narration forward…</p>
<p>On the right, the image steadies the scene…</p>
<p>Margins, rhythm, and pacing mirror Section One…</p>
<p>So the story breathes in familiar cadence.</p>
</div>
</div>
</div>

<section class="galC-left-wrap" id="galC-wrap"></section>
<section class="s11-wrap" id="s11-wrap"></section>
<div class="s11-overlay">
<div class="s11-rail">
<div class="s11-text" id="s11-text">
<p><strong>SECTION ELEVEN</strong> continues the thread…</p>
<p>Back to the left rail; image anchors the right…</p>
<p>Margins and rhythm unchanged…</p>
<p>Standard crossfades keep the cadence…</p>
<p>As the story settles into focus.</p>
</div>
</div>
</div>

<section class="s12-wrap" id="s12-wrap"></section>
<section class="s13-wrap" id="s13-wrap"></section>
<div class="s13-overlay">
<div class="s13-rail">
<div class="s13-text" id="s13-text">
<p><strong>SECTION THIRTEEN</strong> returns to the close frame…</p>
<p>Left-rail narration pulls us forward…</p>
<p>The right-side image steadies the scene…</p>
<p>Margins and rhythm echo Section One…</p>
<p>Breathing at the familiar pace.</p>
</div>
</div>
</div>

<section class="s14-wrap" id="s14-wrap"></section>
<div class="s14-overlay">
<div class="s14-rail">
<div class="s14-text" id="s14-text">
<p><strong>SECTION FOURTEEN</strong> flips the rail…</p>
<p>Text to the right, image to the left…</p>
<p>Pacing and fades match Section Two…</p>
<p>As the view widens and settles…</p>
<p>Into the next cadence.</p>
</div>
</div>
</div>

<section class="s15-wrap" id="s15-wrap"></section>
<div class="s15-overlay">
<div class="s15-rail">
<div class="s15-text" id="s15-text">
<p><strong>Gardenicity</strong> Writing, Design, Curation:<br>
Megama/Rebecca Sternberg, Keren Avni</p>
<p><strong>Photo Credits:</strong><br>
1 - Survey of Israel (MAPI); 2-10, 15-25 - Matson (G. Eric and Edith) Photograph Collection, LOC;
11-14 - NLI Boris Carmi; 26 - Tomer Appelbaum</p>
<p>
<a href="https://www.megama.net" target="_blank">Gardencity what did Geddes See?</a><br>
<a href="https://www.megama.net" target="_blank">Civic Green</a><br>
<a href="https://www.megama.net" target="_blank">Growth</a><br>
<a href="https://www.megama.net" target="_blank">Leafy SDGs</a><br>
<a href="https://www.megama.net" target="_blank">EN/עב</a>
</p>
</div>
</div>
</div>

<section class="after"></section>

<script src="https://api.mapbox.com/mapbox-gl-js/v3.1.2/mapbox-gl.js"></script>
<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoia2F2bmkiLCJhIjoiY2s5YjBqNGY1MGV4aTnobnk0amJncWZweCJ9.gZK_r9CYmb6ZN_mZVmgjNg';

const MAP_START_CENTER = [34.770081, 32.079031]; // Lon, Lat
const MAP_MIN_ZOOM = 13; 
const MAP_START_ZOOM = 15.99;

const mapFrame = document.querySelector('.sMapA-frame');
const mapContainer = document.getElementById('mapA-container');
const mapExitButton = document.getElementById('map-exit-button');
const mapSection = document.querySelector('#sMapA-wrap');

// Initialize the Mapbox GL JS Map
const map = new mapboxgl.Map({
    container: 'mapA-container',
    style: 'mapbox://styles/kavni/cmhkpt4uz00et01pjheur1zc1',
    center: MAP_START_CENTER,
    zoom: MAP_START_ZOOM,
    minZoom: MAP_MIN_ZOOM, 
    interactive: false // Always start disabled
});

// Helper function to disable map and simulate a scroll forward
function triggerScrollForward() {
    disableMapInteractions(); 
    
    // Simulate a strong scroll down to push the map section out of view.
    window.scrollBy({
        top: 2000, 
        behavior: 'smooth' 
    });
}

// Function to disable all map user interactions and re-apply CSS lock
function disableMapInteractions() {
    map.scrollZoom.disable();
    map.dragPan.disable();
    map.doubleClickZoom.disable();
    map.touchZoomRotate.disable();
    
    // V2 Core Lock: CSS hard lock
    mapContainer.style.pointerEvents = 'none'; 
    mapContainer.classList.remove('map-active');
    
    // Hide the exit button
    if (mapExitButton) {
        mapExitButton.style.opacity = '0';
        mapExitButton.style.pointerEvents = 'none'; 
    }
}

// Function to enable map user interactions and release CSS lock
function enableMapInteractions() {
    // V2 Core Unlock: Release CSS hard lock
    mapContainer.style.pointerEvents = 'auto'; 
    
    map.scrollZoom.enable();
    map.dragPan.enable();
    mapContainer.classList.add('map-active');
    
    // Show the exit button
    if (mapExitButton) {
        mapExitButton.style.opacity = '1';
        mapExitButton.style.pointerEvents = 'auto'; 
    }
}

map.on('load', () => {
    // Ensure map is locked on load
    disableMapInteractions(); 
});


// 1. Implicit Engagement (Mouse Enter) - V2 Logic
mapContainer.addEventListener('mouseenter', () => {
    // Only enable if the section is currently visible/active
    if (mapFrame.classList.contains('active')) {
        enableMapInteractions();
    }
});

// 2. Implicit Handover (Mouse Leave) - V2 Logic
mapContainer.addEventListener('mouseleave', () => {
    // Disable map only if the section is currently visible/active
    if (mapFrame.classList.contains('active')) {
        disableMapInteractions();
    }
});

// 3. Explicit Exit (Button Click) - NEW V13 LOGIC
if (mapExitButton) {
    mapExitButton.addEventListener('click', (e) => {
        // Stop the click from registering on the map beneath
        e.stopPropagation();
        triggerScrollForward();
    });
}


// 4. Global Visibility Toggle (Standard Scrollytelling control)
function toggleMapPointer() {
    if (!mapFrame || !mapSection) return;

    const rect = mapSection.getBoundingClientRect();
    // Check if the map section is roughly 80% visible
    const visible = rect.top < window.innerHeight * 0.8 && rect.bottom > window.innerHeight * 0.2;
    
    if (visible) {
        mapFrame.classList.add('active');
        // V2 relies solely on mouseenter/mouseleave for engagement/disengagement here.
    } else {
        mapFrame.classList.remove('active');
        // IMPORTANT: Lock the map if the section scrolls out of view.
        disableMapInteractions();
    }
}

// Add listeners for the main scrollytelling control
window.addEventListener('scroll', toggleMapPointer, { passive: true });
window.addEventListener('resize', toggleMapPointer);

// Initial call to set the correct state
map.on('render', toggleMapPointer);
toggleMapPointer();
</script>

</body>
</html>
